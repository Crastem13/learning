



function jump(url){
	var tmpForm = $("<form  method='post'></form>");
	$(tmpForm).attr("action",url);
	tmpForm.appendTo(document.body).submit();
   
}






$(document).ready(function(){
	
	var autelIDResultTip=$("#autelIDResultTip");
	var actCodeResultTip=$("#actCodeResultTip");
	var userPwdResultTip=$("#userPwdResultTip");
	var userPwd2ResultTip=$("#userPwd2ResultTip");
	var firstNameResultTip=$("#firstNameResultTip");
<!-- 	var middleNameResultTip=$("#middleNameResultTip"); -->
	var lastNameResultTip=$("#lastNameResultTip");
<!-- 	var secondEmailResultTip =$("#secondEmailResultTip"); -->
	var comUsernameResultTip=$("#comUsernameResultTip");
<!-- 	var questionCodeResultTip=$("#questionCodeResultTip"); -->
<!-- 	var answerResultTip=$("#answerResultTip"); -->
	var countryResultTip=$("#countryResultTip");
<!-- 	var addressResultTip=$("#addressResultTip"); -->
<!-- 	var cityResultTip=$("#cityResultTip"); -->
<!-- 	var companyResultTip=$("#companyResultTip"); -->
<!-- 	var zipCodeResultTip=$("#zipCodeResultTip"); -->
	var languageCodeResultTip=$("#languageCodeResultTip");
	var imagenumResultTip=$("#imagenumResultTip");
	var agreeResultTip=$("#agreeResultTip");
	var allowSendEmailResultTip=$("#allowSendEmailResultTip");
	var daytimePhoneResultTip=$("#daytimePhoneResultTip");

   var tempCountry=$('#country').val();
   if(tempCountry=='United States'){
		usaProvince();
	}
   
	
	if('en_US'=='en_US')
	{
<!-- 		$("#middleNameDiv").show(); -->
<!-- 		$("#middleNameTipDiv").show(); -->
		if($("#languageCode").length > 0){
		 $("#languageCode").find("option").each(function (){
			if($(this).text()=="English") $(this).attr("selected", true);
		 });
		 }
		
	}else{
	    if($("#languageCode").length > 0){
		 $("#languageCode").find("option").each(function (){
			if($(this).text()=="Chinese") $(this).attr("selected", true);
		 });
		 }
	}
	
	$("#regCustomerCheck").click(function()
	{
		var $form = $("#regCustomerInfoForm");
		var autelId = $("#autelId").val();
		var useractcode=$.trim($("#actCode").val());
		var password = $("#userPwd").val();
		var confirmPassword = $("#userPwd2").val();
<!-- 		var questionCode = $("#questionCode").val(); -->
		var languageCode = $("#languageCode").val();
<!-- 		var answer = $("#answer").val(); -->
		var firstName = $("#firstName").val();
<!-- 		var middleName = $("#middleName").val(); -->
		var lastName = $("#lastName").val();
<!-- 		var secondEmail = $("#secondEmail").val(); -->
		var country = $("#country").val();
<!-- 		var address = $("#address").val(); -->
<!-- 		var city = $("#city").val(); -->
<!-- 		var company = $("#company").val(); -->
		var comUsername = $("#comUsername").val();
<!-- 		var zipCode = $("#zipCode").val(); -->
		var agree = $("#agree").val();
		var allowSendEmail = $("#allowSendEmail").val();
		var imagenum = $("#imagenum").val();
		var province = $("#province").val();   //20140307 add
		var daytimePhone = $("#daytimePhone").val(); //20160127 add
		
		var regEmail = /^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;
<!--		var regName = /^[\u4e00-\u9fa5-A-Za-z0-9_]+$/i;		 -->
		var regName =/^[\u4E00-\u9FA5A-Za-z\s]+(Â·[\u4E00-\u9FA5A-Za-z]+)*$/;
		
		var regComUsername = /^[\u4e00-\u9fa5-A-Za-z0-9_ ]+$/i;
		var regNumber = /^[0-9]\d*$/;
		var regPwd=new RegExp(/[A-Za-z].*[0-9]|[0-9].*[A-Za-z]/);
	    var operationResultTip = $("#operationResultTip");
	    operationResultTip.html("");
		
		clearAllErrorInfo();
		
		var isFlag=true;
		
		if(autelId == null || autelId == "")
		{
			$("#autelIDResult").show();
			$("#autelIdImg").show();
			autelIDResultTip.html("Please enter your desired Autel ID.");
			
			$("#autelId").focus();
			isFlag =false;
		}
		else if(!regEmail.test(autelId))
		{
			$("#autelIDResult").show();
			$("#autelIdImg").show();
			autelIDResultTip.html("Please enter a valid email address.");
			$("#autelId").focus();
			isFlag =false;
		}
		
		if(useractcode == null || useractcode == ""){
			$("#actCodeResult").show();
			$("#actCodeImg").show();
			actCodeResultTip.html("Please enter the verification code. ");
			if(isFlag){
				$("#actcode").focus();
			}
			isFlag =false;
<!-- 		}else if(actcode == null || actcode == ""){ -->
<!-- 			$("#actCodeResult").show(); -->
<!-- 			$("#actCodeImg").show(); -->

<!-- 			isFlag =false; -->
		}
		
		if(password == null || password == "")
		{
			$("#userPwdResult").show();
			$("#userPwdImg").show();
			userPwdResultTip.html("Please specify a password.");
			if(isFlag){
					$("#userPwd").focus();
			}
			isFlag =false;
		}
		else if(password.length < 6)
		{
			$("#userPwdResult").show();
			$("#userPwdImg").show();
			userPwdResultTip.html("The password cannot be less than six digits.");
			if(isFlag){
					$("#userPwd").focus();
			}
			isFlag =false;
		}else{
			if(!regPwd.test(password)){
	   			$("#userPwdResult").show();
				$("#userPwdImg").show();
				userPwdResultTip.html("Your password must have at least one letter and one number.");
				if(isFlag){
					$("#userPwd").focus();
				}
				isFlag =false;
  			}
		}
		
		if(confirmPassword == null || confirmPassword == "")
		{
			$("#userPwd2Result").show();
			$("#userPwd2Img").show();
			userPwd2ResultTip.html("Please specify a password.");
			if(isFlag){
				$("#userPwd2").focus();
			}
			isFlag =false;
		}
		else if(confirmPassword.length < 6)
		{
			$("#userPwd2Result").show();
			$("#userPwd2Img").show();
			userPwd2ResultTip.html("Confirm Password cannot be less than six digits.");
			if(isFlag){
				$("#userPwd2").focus();
			}
			isFlag =false;
		}
		
		if(password != confirmPassword)
		{
			$("#userPwd2Result").show();
			$("#userPwd2Img").show();
			userPwd2ResultTip.html("Passwords did not match. Please try again.");
			if(isFlag){
				$("#userPwd2").focus();
			}
			isFlag =false;
		}
		
		if(firstName == null || firstName == "")
		{
			$("#firstNameResult").show();
			$("#firstNameImg").show();
			firstNameResultTip.html("Please enter a first name.");
			if(isFlag){
				$("#firstName").focus();
			}
			isFlag =false;
		}
		else
		{
			if(!regName.test(firstName))
			{
				$("#firstNameResult").show();
				$("#firstNameImg").show();
				firstNameResultTip.html("The first name cannot contain invalid characters.");
				if(isFlag){
					$("#firstName").focus();
				}
				isFlag =false;
			}
		}
		
<!-- 		if(middleName != null && middleName !="") -->
<!-- 		{ -->
<!-- 			if(!regName.test(middleName)) -->
<!-- 			{ -->
<!-- 				$("#middleNameResult").show(); -->
<!-- 				$("#middleNameImg").show(); -->

<!-- 				if(isFlag){ -->
<!-- 					$("#middleName").focus(); -->
<!-- 				} -->
<!-- 				isFlag =false; -->
<!-- 			} -->
<!-- 		} -->
		
		if(lastName == null || lastName == "")
		{
			$("#lastNameResult").show();
			$("#lastNameImg").show();
			lastNameResultTip.html("Please enter a last name.");
			if(isFlag){
				$("#lastName").focus();
			}
			isFlag =false;
		}
		else
		{
			if(!regName.test(lastName))
			{
				$("#lastNameResult").show();
				$("#lastNameImg").show();
				lastNameResultTip.html("The last name cannot contain invalid characters.");
				if(isFlag){
					$("#lastName").focus();
				}
				isFlag =false;
			}
		}
	
		
		operationResultTip.html("");
		
<!-- 		if(secondEmail != null && secondEmail !="") -->
<!-- 		{ -->
<!-- 			if(!regEmail.test(secondEmail)) -->
<!-- 			{ -->
<!-- 				$("#secondEmailResult").show(); -->
<!-- 				$("#secondEmailImg").show(); -->

<!-- 				if(isFlag){ -->
<!-- 					$("#secondEmail").focus(); -->
<!-- 				} -->
<!-- 				isFlag =false; -->
<!-- 			} -->
			
<!-- 			operationResultTip.html(""); -->
			
<!-- 			if(secondEmail==autelId) -->
<!-- 			{ -->
<!-- 				$("#secondEmailResult").show(); -->
<!-- 				$("#secondEmailImg").show(); -->

<!-- 				if(isFlag){ -->
<!-- 					$("#secondEmail").focus(); -->
<!-- 				} -->
<!-- 				isFlag =false; -->
<!-- 			} -->
			
<!-- 		} -->
		
		if(comUsername == null || comUsername == "")
		{
			$("#comUsernameResult").show();
			$("#comUsernameImg").show();
			comUsernameResultTip.html("Please enter an user name.");
			if(isFlag){
				$("#comUsername").focus();
			}
			isFlag =false;
		}
		else if(!regComUsername.test(comUsername))
		{
			$("#comUsernameResult").show();
			$("#comUsernameImg").show();
			comUsernameResultTip.html("User name cannot contain invalid characters.");
			if(isFlag){
				$("#comUsername").focus();
			}
			isFlag =false;
		}
		
		operationResultTip.html("");
		
<!-- 		if(questionCode == -1) -->
<!-- 		{ -->
<!-- 			$("#questionCodeResult").show(); -->
<!-- 			$("#questionCodeImg").show(); -->

<!-- 			if(isFlag){ -->
<!-- 				$("#questionCode").focus(); -->
<!-- 			} -->
<!-- 			isFlag =false; -->
<!-- 		} -->
		
<!-- 		operationResultTip.html(""); -->
		
<!-- 		if(answer == null || answer == "") -->
<!-- 		{ -->
<!-- 			$("#answerResult").show(); -->
<!-- 			$("#answerImg").show(); -->

<!-- 			if(isFlag){ -->
<!-- 				$("#answer").focus(); -->
<!-- 			} -->
<!-- 			isFlag =false; -->
<!-- 		} -->
		
		if(country == null || country == "")
		{
			$("#countryResult").show();
			$("#countryImg").show();
			countryResultTip.html("Please enter a country/region.");
			if(isFlag){
				$("#country").focus();
			}
			isFlag =false;
		}
	
		if(daytimePhone == null || daytimePhone == "")
		{
			$("#daytimePhoneResult").show();
			$("#daytimePhoneImg").show();
			daytimePhoneResultTip.html("Please enter the tel. ");
			if(isFlag){
				$("#daytimePhone").focus();
			}
			isFlag =false;
		}
	
		
		if(languageCode == -1)
		{
			$("#languageCodeResult").show();
			$("#languageCodeImg").show();
			languageCodeResultTip.html("Please select a language.");
			if(isFlag){
				$("#languageCode").focus();
			}
			isFlag =false;
		}
		
		if(imagenum == null || imagenum == "")
		{
			$("#imagenumResult").show();
			$("#imagenumImg").show();
			imagenumResultTip.html("Please enter the characters you see to continue.");
			if(isFlag){
				$("#imagenum").focus();
			}
			isFlag =false;
		}
		
		if(agree == 0)
		{
			$("#agreeResult").show();
			$("#agreeImg").show();
			agreeResultTip.html("Please check the box to indicate your acceptance.");
			if(isFlag){
				$("#agree").focus();
			}
			isFlag =false;
		}
		if(allowSendEmail == 0)
		{
			$("#allowSendEmailResult").show();
			$("#allowSendEmailImg").show();
			allowSendEmailResultTip.html("Please tick the E-Mail to receive more information.");
			if(isFlag){
				$("#allowSendEmail").focus();
			}
			isFlag =false;
		}
		if(!isFlag){
			return;
		}
		
		var resultCode = true;
		
		$.ajax({
			url:'front/user/regCustomerCheck.do',
			type:"post",
			async:false,
			data:{"userInfoVo.autelId":autelId,"userInfoVo.imageCode":imagenum,"useractcode":useractcode},
			dataType:'JSON',
			success :function(data)
			{
				var jsonData = eval(data);
				var autelId = jsonData[0].autelId;
				var imageCode = jsonData[0].imageCode;
				var actCode= jsonData[0].actCode;
				
				if(imageCode == "false")
				{
					$("#imagenumResult").show();
					$("#imagenumImg").show();
					imagenumResultTip.html("The entered verification code is incorrect.");
					resultCode = false;
					$("#imageCode").focus();
					return;
				}else if(autelId == "false1"){
				    $("#autelIDResult").show();
					$("#autelIdImg").show();
					autelIDResultTip.html("Please enter your desired Autel ID.");
				    window.setTimeout( function(){ jQuery("#autelId").focus(); }, 0);
					return;
				}
				if(actCode==null||actCode=="false"){
					$("#actCodeResult").show();
					$("#actCodeImg").show();
					actCodeResultTip.html("The verification code you entered is incorrect or invalid. Please re-enter the code or get a new one!");
					resultCode = false;
					return;
				}
				if(autelId == "true")
				{
					$("#autelIDResult").show();
					$("#autelIdImg").show();
					autelIDResultTip.html("The entered account was registered.");
					
					resultCode = false;
					$("#autelId").focus();
					return;
				}
				
			},
			error :function(){
				operationResultTip.html("Network error, please try again later!");
				resultCode=false;
			}
		});
		
		if(resultCode == false)
		{
			return;
		}
		$("#actCode").val(useractcode);
	    $("#regCustomerCheck").attr("disabled","true");
		$form.action="regCustomerInfoResult.html?autelId="+autelId;
		$form.submit();
	});

});
	
function setEmail(obj)
{
	if(obj.checked)
	{
		$("#allowSendEmail").val(1);
		$("#isAllowSendEmail").val(1);
	}
	else
	{
		$("#allowSendEmail").val(0);
		$("#isAllowSendEmail").val(0);
	}
	
}

function setAgree(obj)
{
	if(obj.checked)
	{
		$("#agree").val(1);
	}
	else
	{
		$("#agree").val(0);
	}
}

function clearAllErrorInfo(){
	$("#autelIDResult").hide();
	$("#autelIdImg").hide();
	
	
	$("#au_pwd").hide(); 
	
	$("#actCodeResult").hide();
	$("#actCodeImg").hide();
	
	$("#userPwdResult").hide();
	$("#userPwdImg").hide();
	
	$("#userPwd2Result").hide();
	$("#userPwd2Img").hide();
	
	$("#firstNameResult").hide();
	$("#firstNameImg").hide();
	
<!-- 	$("#middleNameResult").hide(); -->
<!-- 	$("#middleNameImg").hide(); -->
	
	$("#lastNameResult").hide();
	$("#lastNameImg").hide();
	
<!-- 	$("#secondEmailResult").hide(); -->
<!-- 	$("#secondEmailImg").hide(); -->
	
	$("#comUsernameResult").hide();
	$("#comUsernameImg").hide();
	
<!-- 	$("#questionCodeResult").hide(); -->
<!-- 	$("#questionCodeImg").hide(); -->
	
<!-- 	$("#answerResult").hide(); -->
<!-- 	$("#answerImg").hide(); -->
	
	$("#countryResult").hide();
	$("#countryImg").hide();
	
	$("#daytimePhoneResult").hide();
	$("#daytimePhoneImg").hide();
	
<!-- 	$("#addressResult").hide(); -->
<!-- 	$("#addressImg").hide(); -->
	
<!-- 	$("#cityResult").hide(); -->
<!-- 	$("#cityImg").hide(); -->
	
<!-- 	$("#companyResult").hide(); -->
<!-- 	$("#companyImg").hide(); -->
	
<!-- 	$("#zipCodeResult").hide(); -->
<!-- 	$("#zipCodeImg").hide(); -->
	
	$("#languageCodeResult").hide();
	$("#languageCodeImg").hide();
	
	$("#imagenumResult").hide();
	$("#imagenumImg").hide();
	
	$("#allowSendEmailResult").hide();
	$("#allowSendEmailImg").hide();
	
	$("#agreeResult").hide();
	$("#agreeImg").hide();
}

function clearautelIdValue(){
	$("#au_pwd").hide();
	if($("#autelId").val()=="name@example.com")
	{
		$("#autelId").attr("value","");
	} 
	$("#au_id").show();
	checkAutelID();
	
}

function onblurAutelId(){
	$("#au_id").hide();
	var autelId = $("#autelId").val();
	var regEmail = /^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;
	var autelIDResultTip=$("#autelIDResultTip");
	
	if(autelId == null || autelId == "")
	{
		$("#autelIDResult").show();
		$("#autelIdImg").show();
		autelIDResultTip.html("Please enter your desired Autel ID.");
	    window.setTimeout( function(){ jQuery("#autelId").focus(); }, 0);
		return;
	}
	else if(!regEmail.test(autelId))
	{
		$("#autelIDResult").show();
		$("#autelIdImg").show();
		autelIDResultTip.html("Please enter a valid email address.");
		 window.setTimeout( function(){ jQuery("#autelId").focus(); }, 0);
		return;
	}else{
	    $.ajax({
			url:'front/user/checkAutelIDIsUse.do',
			type:"post",
			async:false,
			data:{"userInfoVo.autelId":autelId},
			dataType:'JSON',
			success :function(data)
			{
				var jsonData = eval(data);
				var autelId = jsonData[0].autelId;
				
				if(autelId == "true")
				{
				    $("#autelIDResult").show();
					$("#autelIdImg").show();
					autelIDResultTip.html("The entered account was registered.");
					$("#isUse").attr("color","red");
					 window.setTimeout( function(){ jQuery("#autelId").focus(); }, 0);
					return;
				}else if(autelId == "false1"){
				    $("#autelIDResult").show();
					$("#autelIdImg").show();
					autelIDResultTip.html("Please enter your desired Autel ID.");
				    window.setTimeout( function(){ jQuery("#autelId").focus(); }, 0);
					return;
				}
				else if(autelId == "SystemError"){
				    $("#autelIDResult").show();
					$("#autelIdImg").show();
					autelIDResultTip.html("System error, please mail to support@auteltech.com.");
					$("#isUse").attr("color","red");
					 window.setTimeout( function(){ jQuery("#autelId").focus(); }, 0);
					return;
				}
				else{
				   $("#isUse").attr("color","");
					$("#autelIDResult").hide();
					$("#autelIdImg").hide();
				}
			}
		}); 
	}
}

function onbluruserPwdValue(){
	$("#au_pwd").hide();
	var password = $("#userPwd").val();
	var userPwdResultTip=$("#userPwdResultTip");
	var regPwd=new RegExp(/[A-Za-z].*[0-9]|[0-9].*[A-Za-z]/);
	if(password == null || password == "")
	{
		$("#userPwdResult").show();
		$("#userPwdImg").show();
		userPwdResultTip.html("Please specify a password.");
	}
	else if(password.length < 6)
	{
		$("#userPwdResult").show();
		$("#userPwdImg").show();
		userPwdResultTip.html("The password cannot be less than six digits.");
	}else if(!regPwd.test(password)){
	   	$("#userPwdResult").show();
		$("#userPwdImg").show();
		userPwdResultTip.html("Your password must have at least one letter and one number.");
	}else{
		$("#userPwdResult").hide();
		$("#userPwdImg").hide();
	}
	
	var confirmPassword = $("#userPwd2").val();
	var userPwd2ResultTip=$("#userPwd2ResultTip");
	if(confirmPassword !=null && confirmPassword!= ""){
		if(password != confirmPassword){
				$("#userPwd2Result").show();
				$("#userPwd2Img").show();
				userPwd2ResultTip.html("Passwords did not match. Please try again.");
		}else{
				$("#userPwd2Result").hide();
				$("#userPwd2Img").hide();
		}
	}
		
}

function userPwdValue(){
	$("#au_id").hide();
	$("#au_pwd").show();
	checkAutelPwd();
	
}

function onblurUserPwd2Value(){
		var password = $("#userPwd").val();
		var confirmPassword = $("#userPwd2").val();
		var userPwd2ResultTip=$("#userPwd2ResultTip");
		if(password != confirmPassword){
			$("#userPwd2Result").show();
			$("#userPwd2Img").show();
			userPwd2ResultTip.html("Passwords did not match. Please try again.");
		}else{
			$("#userPwd2Result").hide();
			$("#userPwd2Img").hide();
		}
}


function checkAutelID(){
	var autelId = $("#autelId").val();
	var regEmail = /^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;
	if(!regEmail.test(autelId))
	{
		$("#emailError").attr("color","#ea0000");
		return;
	}else{
		$("#emailError").attr("color","");
	}
}

var times=59;
function getActCode(){
	var autelId = $("#autelId").val();
	var languageCode = $("#languageCode").val();
	var regEmail = /^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;
	var autelIDResultTip=$("#autelIDResultTip");
	if(autelId == null || autelId == "" || autelId == "name@example.com")
		{
			$("#autelId").val("");
			$("#autelIDResult").show();
			$("#autelIdImg").show();
			autelIDResultTip.html("Please enter your desired Autel ID.");
			$("#autelId").focus();
			return;
		}
		else if(!regEmail.test(autelId))
		{
			$("#autelIDResult").show();
			$("#autelIdImg").show();
			autelIDResultTip.html("Please enter a valid email address.");
			$("#autelId").focus();
			return;
		}
	$("#getactcodes").attr("disabled","disabled");
	settime(document.getElementById("getactcodes"));
	 $.ajax({
			url:'front/user/sendActCode.do',
			type:"post",
			async:false,
			data:{"userInfoVo.autelId":autelId,"userInfoVo.languageCode":languageCode},
			dataType:'JSON',
			success :function(data)
			{
				var jsonData = eval(data);
				var result = jsonData[0].result;
				if(result=="true"){
<!-- 					$("#actCode").removeAttr("disabled"); -->
				}else{
					alert("send error!");
				}
				
			}
	});
}
function settime(obj) {
		if (times == 0) {
			obj.removeAttribute("disabled");
			obj.value= "Get verification code";
			times = 59;
			return;
		} else {
			obj.setAttribute("disabled", true);
			obj.value= "Resend("+times+")";
			times--;
		}
		setTimeout(function() {
			settime(obj);
		}, 1000);
	};


function checkAutelPwd(){
	var password = $("#userPwd").val();
	var regPwd=new RegExp(/[A-Za-z].*[0-9]|[0-9].*[A-Za-z]/);
	if(password.length < 6)
	{
		$("#lengthError").attr("color","#ea0000");
	}else{
		$("#lengthError").attr("color","");
	}
	
	if(!regPwd.test(password)){
	   	$("#numberError").attr("color","#ea0000");
  	}else{
  		$("#numberError").attr("color","");
  	}
}






